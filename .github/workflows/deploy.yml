name: üöÄ D√©ploiement
on:
  release:
    types: [published]

jobs:
  trigger-deployment:
    name: üîî Notify Deployment Server
    runs-on: ubuntu-latest

    # ‚ö†Ô∏è S√âCURIT√â : Ne se d√©clenche pas si c'est une "pre-release" (ex: v1.0.0-beta)
    # Si vous voulez d√©ployer les pre-releases, supprimez cette ligne.
    if: github.event.release.prerelease == false

    steps:
      - name: R√©cup√©ration des informations de la version
        id: release-info
        run: |
          echo "Release Tag: ${{ github.event.release.tag_name }}"
          echo "Release Name: ${{ github.event.release.name }}"
          echo "Triggering deployment..."

      - name: Appel du webhook de d√©ploiement
        run: |
          curl -X POST \
            --fail \
            -H "Content-Type: application/json" \
            -H "Accept: application/json" \
            -d '{"event_type": "new_release", "tag_name": "${{ github.event.release.tag_name }}", "release_name": "${{ github.event.release.name }}", "repository": "${{ github.repository }}"}' \
            ${{ secrets.DEPLOY_WEBHOOK_URL }}
